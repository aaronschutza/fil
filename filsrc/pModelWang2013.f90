
real function pModelWang2013(r,phi,kpi,swi)
implicit none
real :: r,phi
!Radial pressure model from: 10.1002/jgra.50585
real,dimension(6) :: b1,b2,b3,b4,b5,b6,b7,b8,b9
real,dimension(6) :: b1e,b2e,b3e,b4e,b5e,b6e,b7e,b8e,b9e
real,dimension(6) :: Rcorr,ErrRMS,ErrMean
integer :: kpi,swi

!Pmodel[nPa](r[Re],phi) = exp(b1*r)*(b2 + b3*sin(phi) + b4 * sin(phi)**2)
!			+ r**b5    *(b6 + b7*sin(phi) + b8 * sin(phi)**2)
!			+ b9
!kpi:


! Rcorr is the linear correlation coefficient between Pm and Pt,n. ErrRMS is the normalized RMS error. ErrMean is the normalized mean error.
if(swi < 1)then
! 	Kp = 0	Kp = 1	Kp = 2	Kp = 3	Kp = 4	Kp = 5
!   PSW = 1.5	
	b1=(/-0.8700,-0.7890,-0.7888,-0.6887,-0.6590,-0.7311/)
	b1e=(/0.0484,0.0565,0.0639,0.0657,0.1408,0.1161/)
	b2=(/213.5363,123.7894,73.3651,99.6864,60.2186,137.1203/)
	b2e=(/36.7470,26.1173,30.6172,23.4886,35.6205,511.8743/)
	b3=(/0.0322,-0.1999,38.6285,-5.7370,-27.2739,166.9548/)
	b3e=(/8.4077,1.5009,1.8424,1.3305,1.4691,9.4334/)
	b4=(/99.2106,73.8102,99.9520,15.4089,29.3575,231.5938/)
	b4e=(/26.9372,24.8810,38.5686,12.4035,27.6130,441.4238/)
	b5=(/-1.2410,-1.2334,-2.0651,-1.2622,-1.5970,-1.7076/)
	b5e=(/0.6442,0.8023,0.3870,0.8439,0.1755,0.8687/)
	b6=(/7.3564,11.2507,69.7594,15.3724,39.4608,53.7482/)
	b6e=(/1.5667,3.0741,4.7404,2.8034,18.0344,132.4751/)
	b7=(/-0.5093,0.0502,0.2883,0.0242,1.3241,-3.5660/)
	b7e=(/0.0855,0.1339,0.1741,0.1715,0.3648,1.2279/)
	b8=(/2.0266,-0.0773,9.8675,0.2230,-4.0530,-12.5359/)
	b8e=(/0.2359,0.3020,0.3484,0.3125,1.5940,8.138/)
	b9=(/0.0056,-0.0611,0.0787,-0.0864,-0.0393,0.0104/)
	b9e=(/0.8397,0.9703,0.3038,0.4947,0.1880,0.2769/)
	Rcorr	=(/0.94402,0.93681,0.9255,0.93407,0.87015,0.85403/)
	ErrRMS	=(/0.028,0.033,0.032,0.036,0.034,0.034/)
	ErrMean =(/	0.102,0.093,0.112,0.131,0.124,0.236/)

else
	!Kp = 0	Kp = 1	Kp = 2	Kp = 3	Kp = 4	Kp = 5
	!PSW = 3
	b1=(/-0.9072,-0.9024,-0.8432,-0.8264,-0.6909,-0.7906/)
	b1e=(/0.0518,0.0602,0.0669,0.0811,0.3460,0.1316/)
	b2=(/240.0024,152.1005,65.3578,109.6771,8.1615,188.7615/)
	b2e=(/47.0330,31.7535,34.2491,31.4862,82.7838,84.8879/)
	b3=(/-2.8333,2.6496,-63.4070,-6.4229,-31.6261,209.6659/)
	b3e=(/4.6522,2.4269,1.1343,0.2219,0.3266,3.6729/)
	b4=(/135.1886,126.1990,172.1954,25.9049,43.7472,218.4614/)
	b4e=(/39.0879,37.2681,52.6818,15.8282,74.4886,167.0783/)
	b5=(/-0.4292,-1.2436,-1.5136,-1.5213,-1.7950,-1.7408/)
	b5e=(/0.1658,0.5513,0.2516,0.5247,0.2437,0.3538/)
	b6=(/3.7857,16.7792,34.4588,39.0839,88.8841,76.1308/)
	b6e=(/1.2484,7.8300,2.0089,21.9181,33.9701,24.6083/)
	b7=(/-0.0752,-0.0745,0.6017,-0.5118,1.3109,-2.8949/)
	b7e=(/0.0976,0.2987,0.2004,0.4317,1.7290,1.5301/)
	b8=(/0.2609,-0.1996,-2.5027,0.0237,-11.9868,-15.0630/)
	b8e=(/0.5078,0.5059,0.4430,0.7579,0.8781,3.8129/)
	b9=(/-0.7513,-0.0718,0.0093,-0.0090,0.0306,0.1342/)
	b9e=(/0.7740,0.7139,0.5570,0.0205,0.0818,0.1815/)
	Rcorr	=(/0.93959,0.93112,0.92439,0.932,0.86305,0.83832/)
	ErrRMS	=(/0.029,0.034,0.033,0.037,0.035,0.033/)
	ErrMean	=(/0.096,0.088,0.129,0.136,0.132,0.375/)
endif

pModelWang2013 = exp(b1(kpi+1)*r) *(b2(kpi+1) + b3(kpi+1)*sin(phi) + b4(kpi+1) * sin(phi)**2) &
			&  +  r**b5(kpi+1)    *(b6(kpi+1) + b7(kpi+1)*sin(phi) + b8(kpi+1) * sin(phi)**2) &
			&  +     b9(kpi+1)

end function

